var GoogleSpreadsheetsParser,GoogleSpreadsheetsUtil;
GoogleSpreadsheetsUtil=function(){function d(){}d.prototype.extractKey=function(b){b=b.match(/https:\/\/docs.google.com\/spreadsheets\/d\/(.+)\/pubhtml/);return null===b||2!==b.length?null:b[1]};d.prototype.getWorksheetId=function(b){var a;a=new XMLHttpRequest;a.open("GET","https://spreadsheets.google.com/feeds/worksheets/"+b+"/public/basic?alt=json",!1);a.send();b=[];200===a.status&&(a=JSON.parse(a.responseText),b=a.feed.entry[0].id.$t.match(/https:\/\/spreadsheets.google.com\/feeds\/worksheets\/.+\/public\/basic\/(.+)/));return null===
b||2!==b.length?null:b[1]};d.prototype.getFeeds=function(b,a){var c,e;e=new XMLHttpRequest;e.open("GET","https://spreadsheets.google.com/feeds/cells/"+b+"/"+a+"/public/values?alt=json",!1);e.send();c=null;200===e.status&&(c=JSON.parse(e.responseText));return c};d.prototype.makeTitle=function(b){var a,c,e,d;d=[];c=0;for(e=b.length;c<e;c++){a=b[c];a=a.gs$cell;if(null===a)break;if(1===Number(a.row))d.push(a.$t);else break}return d};d.prototype.makeContents=function(b){var a,c,e,d,h,f,g;e=[];if(!(1<=
b.length&&b[0].gs$cell))return e;c=Number(b[b.length-1].gs$cell.col);d=g=0;for(h=b.length;d<h;d++)a=b[d],a=a.gs$cell,1!==Number(a.row)&&(a.row!==g&&(g=a.row,f=[]),f.push(a.$t),Number(a.col)===c&&(e.push(f),f=[]));return e};return d}();GoogleSpreadsheetsParser=function(){return function(d,b){var a,c,e;null==b&&(b=!1);a=new GoogleSpreadsheetsUtil;c=a.extractKey(d);e=a.getWorksheetId(c);c=a.getFeeds(c,e).feed.entry;b&&(this.titles=a.makeTitle(c));this.contents=a.makeContents(c)}}();
